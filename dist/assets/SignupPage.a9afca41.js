import{r as i,e as v,c as w,A as u,E as C,F as E,G as S,H as k,i as B,I,J as q,K as L,a as s,j as a,L as P,l as F}from"./index.31036f5b.js";import{u as U,c as $,a as n,b as T}from"./useBlocker.8880154f.js";import{c as j}from"./countries.b6e2c65b.js";import{u as A}from"./index.00a64885.js";import{S as H}from"./SmallLoader.eee8d13f.js";const R={firstName:"",lastName:"",email:"",password:"",country:""},O=()=>{const[l,c]=i.exports.useState(null),[p,d]=i.exports.useState(!0),t=v(r=>r.authReducer),o=w(),e=U({initialValues:R,validationSchema:$({firstName:n().required("required!"),lastName:n().required("required!"),email:n().email("Please enter a valid email").required("Email must be provided!"),password:n().min(6,"password must have atleast 6 characters!").required("Password must be provided!"),country:n().required("Please select your country!")}),onSubmit:r=>{l!==null&&(o(u(!1)),o(C({email:r.email,password:r.password,returnSecureToken:!0})))}});i.exports.useEffect(()=>{if(t.success===!0){const r=E(S,`images/${e.values.email.toLowerCase()}`),m=A();k(B(F,`/users/${m}`),{uid:m,name:e.values.firstName+" "+e.values.lastName,nationality:e.values.country,email:e.values.email.toLowerCase(),cart:[],totalNumberOfItem:0}),I(r,l).then(()=>console.log("Image uploaded")),setTimeout(()=>{o(q())},1500)}t.error!=null&&setTimeout(()=>{o(L())},1500)},[t.success,t.error]),i.exports.useEffect(()=>{e.dirty&&o(u(!0))},[e.dirty]);const h=e.touched.firstName&&e.errors.firstName,x=e.touched.lastName&&e.errors.lastName,f=e.touched.email&&e.errors.email,g=e.touched.password&&e.errors.password,N=e.touched.country&&e.errors.country;T("You haven't finished filling the form, are you sure you want to leave this page?",t.isEditing);const b=r=>{c(r.currentTarget.files[0])},y=()=>{d(l!==null)};return s("div",{className:"bg-gray-100 p-8 px-5 sm:px-8 max-w-[30rem] mx-auto mt-[3rem] rounded-lg animate-slideup ",children:[a("h1",{className:"text-[#a75b29] text-2xl font-bold text-center mb-4",children:"Signup"}),s("form",{onSubmit:e.handleSubmit,className:"text-center",children:[s("div",{className:"flex gap-2",children:[s("div",{className:"flex flex-col flex-1",children:[a("input",{type:"text",name:"firstName",id:"firstName",placeholder:"First Name",value:e.values.firstName,onBlur:e.handleBlur,onChange:e.handleChange,className:"block h-[3rem] w-full border rounded-lg pl-4  text-sm sm:text-base outline-[#a75b29]"}),h&&a("p",{className:"text-red-600 text-center",children:e.errors.firstName})]}),s("div",{className:" flex flex-col flex-1",children:[a("input",{type:"text",name:"lastName",id:"lastName",placeholder:"Last Name",value:e.values.lastName,onBlur:e.handleBlur,onChange:e.handleChange,className:"block h-[3rem] w-full border rounded-lg pl-4  text-sm sm:text-base outline-[#a75b29]"}),x&&a("p",{className:"text-red-600 text-center",children:e.errors.lastName})]})]}),a("input",{type:"text",name:"email",id:"email",placeholder:"Email",value:e.values.email,onBlur:e.handleBlur,onChange:e.handleChange,className:"block h-[3rem] w-full border rounded-lg pl-4 my-4 text-sm sm:text-base outline-[#a75b29]"}),f&&a("p",{className:"text-red-600 text-center",children:e.errors.email}),a("input",{type:"password",name:"password",id:"password",placeholder:"Password",value:e.values.password,onBlur:e.handleBlur,onChange:e.handleChange,className:"block h-[3rem] w-full border rounded-lg pl-4 my-4 text-sm sm:text-base outline-[#a75b29]"}),g&&a("p",{className:"text-red-600 text-center",children:e.errors.password}),s("select",{name:"country",id:"nationality",placeholder:"country",value:e.values.country,onChange:e.handleChange,className:"block h-[3rem] w-full border rounded-lg px-4 my-4 text-sm sm:text-base outline-[#a75b29]",children:[a("option",{value:"",selected:!0,disabled:!0,children:"Choose your country"}),j.map(r=>a("option",{value:r,children:r},r))]}),N&&a("p",{className:"text-red-600 text-center",children:e.errors.country}),s("div",{className:"flex gap-2 mt-4",children:[a("div",{className:`${p?"":"border-red-600"} border flex-1 px-2 py-2 text-start rounded-lg`,children:l==null?void 0:l.name}),a("label",{htmlFor:"files",className:"bg-[#C56E33] hover:bg-[#a75b29] text-white px-5 py-3 rounded-xl h-[3rem]",children:"Choose Image"}),a("input",{id:"files",type:"file",className:"hidden",onChange:b})]}),a("button",{className:"border-none px-5 py-2 hover:bg-[#a75b29] bg-[#C56E33] text-white rounded-lg w-[10rem] mt-4",onClick:y,children:"Signup"}),a(P,{to:"/signin",className:"text-gray-400 text-sm mt-2 hover:text-[#C56E33] cursor-pointer block",children:"login with existing user"}),t.isLoading&&a(H,{}),t.error&&a("p",{className:"text-red-600 text-center mt-2",children:t.error}),t.success&&a("p",{className:"text-green-500 text-center mt-2",children:"success!"})]})]})};export{O as default};
